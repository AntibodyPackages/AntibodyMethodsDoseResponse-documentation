<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Results and simulations · AntibodyMethodsDoseResponse</title><meta name="title" content="Results and simulations · AntibodyMethodsDoseResponse"/><meta property="og:title" content="Results and simulations · AntibodyMethodsDoseResponse"/><meta property="twitter:title" content="Results and simulations · AntibodyMethodsDoseResponse"/><meta name="description" content="Documentation for AntibodyMethodsDoseResponse."/><meta property="og:description" content="Documentation for AntibodyMethodsDoseResponse."/><meta property="twitter:description" content="Documentation for AntibodyMethodsDoseResponse."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="AntibodyMethodsDoseResponse logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">AntibodyMethodsDoseResponse</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../QuickStart/">Quick start</a></li><li><span class="tocitem">Detailed explanations</span><ul><li><a class="tocitem" href="../MeasurementData/">Measurement data</a></li><li><a class="tocitem" href="../Models/">Models</a></li><li class="is-active"><a class="tocitem" href>Results and simulations</a><ul class="internal"><li><a class="tocitem" href="#Why-OneDimGrid-objects?"><span>Why <code>OneDimGrid</code> objects?</span></a></li><li><a class="tocitem" href="#Simulating-the-K_\\tau-density"><span>Simulating the <span>$K_\tau$</span>-density</span></a></li><li><a class="tocitem" href="#Simulating-the-dose-response-curve"><span>Simulating the dose-response curve</span></a></li><li><a class="tocitem" href="#Importing-fitting-results"><span>Importing fitting results</span></a></li></ul></li><li><a class="tocitem" href="../DensityPlots/">Density plots for <code>OneDimGrid</code></a></li><li><a class="tocitem" href="../Fitting/">Fitting</a></li><li><a class="tocitem" href="../Uncertainty/">Uncertainty estimation</a></li></ul></li><li><span class="tocitem">FittingObjectiveFunctions</span><ul><li><a class="tocitem" href="../FittingObjectiveFunctions/">Introduction</a></li><li><a class="tocitem" href="../FittingObjectiveFunctions/fitting_data/">FittingData and ModelFunctions</a></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Least squares objective</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../FittingObjectiveFunctions/lsq_background/">Background</a></li><li><a class="tocitem" href="../FittingObjectiveFunctions/lsq_implementation/">How to implement</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Posterior probability</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../FittingObjectiveFunctions/posterior_background/">Background</a></li><li><a class="tocitem" href="../FittingObjectiveFunctions/posterior_implementation/">How to implement</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Logarithmic posterior probability</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../FittingObjectiveFunctions/log_posterior_background/">Background</a></li><li><a class="tocitem" href="../FittingObjectiveFunctions/log_posterior_implementation/">How to implement</a></li></ul></li></ul></li><li><a class="tocitem" href="../AdaptiveDensityApproximation/">AdaptiveDensityApproximation</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../API/">AntibodyMethodsDoseResponse</a></li><li><a class="tocitem" href="../API_Convenience/">AntibodyMethodsDoseResponseConvenience</a></li><li><a class="tocitem" href="../FittingObjectiveFunctions/API/">FittingObjectiveFunctions</a></li><li><a class="tocitem" href="../AdaptiveDensityApproximation/api/">AdaptiveDensityApproximation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Detailed explanations</a></li><li class="is-active"><a href>Results and simulations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Results and simulations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AntibodyPackages/AntibodyMethodsDoseResponse" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AntibodyPackages/AntibodyMethodsDoseResponse/blob/main/docs/src/ResultsAndSimulations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Results-and-Simulations"><a class="docs-heading-anchor" href="#Results-and-Simulations">Results and Simulations</a><a id="Results-and-Simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Results-and-Simulations" title="Permalink"></a></h1><h2 id="Why-OneDimGrid-objects?"><a class="docs-heading-anchor" href="#Why-OneDimGrid-objects?">Why <code>OneDimGrid</code> objects?</a><a id="Why-OneDimGrid-objects?-1"></a><a class="docs-heading-anchor-permalink" href="#Why-OneDimGrid-objects?" title="Permalink"></a></h2><p>The model generator requires a <code>OneDimGrid</code> objects from the <a href="../AdaptiveDensityApproximation/#AdaptiveDensityApproximation">AdaptiveDensityApproximation</a> package (see <a href="../Models/#binding_models">Models</a>). For this, the actual weights of the grid do not matter. The model generator returns a new parameter array with the goal to estimate these parameters. At this point it is also possible to choose parameter values for this array and to simulate dose-response curves with the corresponding model function.</p><p>But the <a href="../AdaptiveDensityApproximation/#AdaptiveDensityApproximation">AdaptiveDensityApproximation</a> offers additional methods, e.g. the name-giving adaptive approximation of densities or additional density conversion / analysis tools. For this reason, internal methods use <code>OneDimGrid</code> objects and construct the model functions from scratch for the calculation of dose-response curves. This is, among others, the reason why most functions (e.g. the convenience functions of <a href="../API_Convenience/#api_convenience"><code>AntibodyMethodsDoseResponseConvenience</code></a>) return or expect those grids. </p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Although not necessary for all analyses, it is highly recommended to use the <code>OneDimGrid</code> workflow, as advanced methods of this package will expect grids.</p></div></div><h2 id="Simulating-the-K_\\tau-density"><a class="docs-heading-anchor" href="#Simulating-the-K_\\tau-density">Simulating the <span>$K_\tau$</span>-density</a><a id="Simulating-the-K_\\tau-density-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-the-K_\\tau-density" title="Permalink"></a></h2><p>To simulate a dose-response curve with a binding model, a density <span>$g(K_\tau)$</span> needs to be defined. This can be done with any Julia function, e.g. a probability density function:</p><pre><code class="language-julia hljs">using AntibodyMethodsDoseResponseConvenience
using Distributions

p(x) = pdf(Normal(1e-5,3e-6),x)
plot(p, xaxis = :log, xlims = [1e-10,1e-2], fill = 0, label = &quot;density&quot;)</code></pre><img src="333e15f2.svg" alt="Example block output"/><p>The <code>plot</code> function can be used without importing <code>Plots.jl</code>, as <a href="../API_Convenience/#api_convenience"><code>AntibodyMethodsDoseResponseConvenience</code></a> does this in the background automatically.</p><p>Next, a <code>OndDimGrid</code> needs to be defined to approximate the density with:</p><pre><code class="language-julia hljs">grid = create_grid(LogRange(1e-10,1e-2,50))
approximate_density!(grid, p, volume_normalization = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">AdaptiveDensityApproximation.OneDimGrid{Dict{String, AdaptiveDensityApproximation.OneDimBlock}}(Dict{String, AdaptiveDensityApproximation.OneDimBlock}(&quot;XrpNDVC09Z&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;XrpNDVC09Z&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(5.963623316594637e-8, 8.68511373751352e-8), [&quot;dLeUFEiuJR&quot;, &quot;xmkNX8Jfo8&quot;], 1.5172696212583168e-5), &quot;xmkNX8Jfo8&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;xmkNX8Jfo8&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(8.68511373751352e-8, 1.2648552168552957e-7), [&quot;XrpNDVC09Z&quot;, &quot;pwWf8zijxu&quot;], 2.29251412932436e-5), &quot;dLeUFEiuJR&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;dLeUFEiuJR&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(4.094915062380419e-8, 5.963623316594637e-8), [&quot;qhrDgQIofU&quot;, &quot;XrpNDVC09Z&quot;], 1.0157594604868043e-5), &quot;oIYEclPVBR&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;oIYEclPVBR&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(3.727593720314938e-6, 5.428675439323859e-6), [&quot;B6H5B3cI4U&quot;, &quot;Eg31EYsgVC&quot;], 0.044182244405070875), &quot;3dOphipWOn&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;3dOphipWOn&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(7.906043210907702e-6, 1.1513953993264481e-5), [&quot;Eg31EYsgVC&quot;, &quot;VbiBbr0oy6&quot;], 0.47754627394444393), &quot;TIDsH0NlaS&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;TIDsH0NlaS&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(2.94705170255181e-9, 4.291934260128778e-9), [&quot;z9ndS1nipG&quot;, &quot;5ne63GUXJe&quot;], 6.941803541492311e-7), &quot;HM9p1M3IAv&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;HM9p1M3IAv&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(8.286427728546859e-7, 1.2067926406393288e-6), [&quot;L5qoCW3fES&quot;, &quot;oYHgdypztd&quot;], 0.0005686103016830202), &quot;LZu4NqJC6S&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;LZu4NqJC6S&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(3.088843596477472e-10, 4.4984326689694345e-10), [&quot;X4Ajt74KLZ&quot;, &quot;4Nv5dLZ2IP&quot;], 7.249653871503817e-8), &quot;z9ndS1nipG&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;z9ndS1nipG&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(2.0235896477251556e-9, 2.94705170255181e-9), [&quot;ExjJctE9CV&quot;, &quot;TIDsH0NlaS&quot;], 4.76058019338558e-7), &quot;dH3YXedGF4&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;dH3YXedGF4&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(9.540954763499962e-10, 1.3894954943731304e-9), [&quot;LKKSbxLnX8&quot;, &quot;ExjJctE9CV&quot;], 2.2412770711543273e-7)…))</code></pre><div class="admonition is-info"><header class="admonition-header">volume_normalization = true</header><div class="admonition-body"><p>Without <code>volume_normalization = true</code> (the default), the density function itself is approximated (e.g. by using the function values at the centers of the respective intervals). The volume normalization approximates the area under the curve by using <code>function value × interval length</code>. This is a convenient choice for simulations, as the area under a density curve corresponds to the number of epitopes in the given interval, which is exactly what the weights of the grid should be.</p></div></div><p>To inspect the grid, the plotting recipe from the <code>AdaptiveDensityApproximationRecipes</code> package can be used (as already described in <a href="../Models/#binding_models">Models</a>):</p><pre><code class="language-julia hljs">using AdaptiveDensityApproximationRecipes
plot(grid, xaxis = :log)</code></pre><img src="cac16371.svg" alt="Example block output"/><div class="admonition is-info"><header class="admonition-header">y-axis scale</header><div class="admonition-body"><p>Since the grid approximates the area under the density curve (weights correspond to the height of the bars), the scale of the <span>$y$</span>-axis is different, compared to the density plot.</p></div></div><h2 id="Simulating-the-dose-response-curve"><a class="docs-heading-anchor" href="#Simulating-the-dose-response-curve">Simulating the dose-response curve</a><a id="Simulating-the-dose-response-curve-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-the-dose-response-curve" title="Permalink"></a></h2><p>With the <code>OneDimeGrid</code> object <code>grid</code>, a dose-response can be simulated, using <a href="../API/#AntibodyMethodsDoseResponse.DoseResponseResult"><code>DoseResponseResult</code></a>:</p><pre><code class="language-julia hljs">concentrations = LogRange(1e-8,1e-2,16)
simulation_result = DoseResponseResult(grid,concentrations; model = accumulation_model, offset = 0)
scatter(simulation_result, xaxis = :log)</code></pre><img src="3399ed7e.svg" alt="Example block output"/><div class="admonition is-info"><header class="admonition-header">DoseResponseResult</header><div class="admonition-body"><p><code>DoseResponseResult</code> objects are used to construct and store dose-response curves, resulting from grids. This can be either because a grid was used to simulate a <span>$K_\tau$</span>-density or because the result of a model-fit was stored in a grid. The package <code>AntibodyMethodsDoseResponseRecipes</code> provides a plotting recipe for <code>DoseResponseResult</code> objects.</p></div></div><div class="admonition is-success"><header class="admonition-header">filter_zeros</header><div class="admonition-body"><p>The same <code>filter_zeros</code> keyword that is used for <a href="../FittingObjectiveFunctions/fitting_data/#FittingData"><code>FittingData</code></a> plots can also be used for <a href="../API/#AntibodyMethodsDoseResponse.DoseResponseResult"><code>DoseResponseResult</code></a> plots (see <a href="../MeasurementData/#measurement_data_plotting">Measurement Data plotting</a>).</p></div></div><h2 id="Importing-fitting-results"><a class="docs-heading-anchor" href="#Importing-fitting-results">Importing fitting results</a><a id="Importing-fitting-results-1"></a><a class="docs-heading-anchor-permalink" href="#Importing-fitting-results" title="Permalink"></a></h2><p>Instead of simulating a dose-response curve, the <code>OneDimGrid</code> and <a href="../API/#AntibodyMethodsDoseResponse.DoseResponseResult"><code>DoseResponseResult</code></a> types can also be used to create dose-response curves from a fitting result. Since no data has been fitted yet, we construct a result from the weights of the simulation grid above:</p><pre><code class="language-julia hljs">parameters = export_weights(grid)
push!(parameters, 0.2) # Add offset parameter</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">50-element Vector{Float64}:
 2.346375744346489e-8
 3.417353548949335e-8
 4.977309020637278e-8
 7.249653871503817e-8
 1.0560053397755286e-7
 1.5383426307070923e-7
 2.2412770711543273e-7
 3.2660201444611645e-7
 4.76058019338558e-7
 6.941803541492311e-7
 ⋮
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.2</code></pre><p>We assume now, that the <code>gird</code> was used to obtain the model function and that the <code>parameters</code> are the result of the model fit. In this case, the <code>offset</code> keyword was used. To import the result into the grid, the <a href="../AdaptiveDensityApproximation/api/#AdaptiveDensityApproximation.import_weights!"><code>import_weights!</code></a> functions can be used:</p><pre><code class="language-julia hljs">import_weights!(grid, parameters[1:end-1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">AdaptiveDensityApproximation.OneDimGrid{Dict{String, AdaptiveDensityApproximation.OneDimBlock}}(Dict{String, AdaptiveDensityApproximation.OneDimBlock}(&quot;XrpNDVC09Z&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;XrpNDVC09Z&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(5.963623316594637e-8, 8.68511373751352e-8), [&quot;dLeUFEiuJR&quot;, &quot;xmkNX8Jfo8&quot;], 1.5172696212583168e-5), &quot;xmkNX8Jfo8&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;xmkNX8Jfo8&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(8.68511373751352e-8, 1.2648552168552957e-7), [&quot;XrpNDVC09Z&quot;, &quot;pwWf8zijxu&quot;], 2.29251412932436e-5), &quot;dLeUFEiuJR&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;dLeUFEiuJR&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(4.094915062380419e-8, 5.963623316594637e-8), [&quot;qhrDgQIofU&quot;, &quot;XrpNDVC09Z&quot;], 1.0157594604868043e-5), &quot;oIYEclPVBR&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;oIYEclPVBR&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(3.727593720314938e-6, 5.428675439323859e-6), [&quot;B6H5B3cI4U&quot;, &quot;Eg31EYsgVC&quot;], 0.044182244405070875), &quot;3dOphipWOn&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;3dOphipWOn&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(7.906043210907702e-6, 1.1513953993264481e-5), [&quot;Eg31EYsgVC&quot;, &quot;VbiBbr0oy6&quot;], 0.47754627394444393), &quot;TIDsH0NlaS&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;TIDsH0NlaS&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(2.94705170255181e-9, 4.291934260128778e-9), [&quot;z9ndS1nipG&quot;, &quot;5ne63GUXJe&quot;], 6.941803541492311e-7), &quot;HM9p1M3IAv&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;HM9p1M3IAv&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(8.286427728546859e-7, 1.2067926406393288e-6), [&quot;L5qoCW3fES&quot;, &quot;oYHgdypztd&quot;], 0.0005686103016830202), &quot;LZu4NqJC6S&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;LZu4NqJC6S&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(3.088843596477472e-10, 4.4984326689694345e-10), [&quot;X4Ajt74KLZ&quot;, &quot;4Nv5dLZ2IP&quot;], 7.249653871503817e-8), &quot;z9ndS1nipG&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;z9ndS1nipG&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(2.0235896477251556e-9, 2.94705170255181e-9), [&quot;ExjJctE9CV&quot;, &quot;TIDsH0NlaS&quot;], 4.76058019338558e-7), &quot;dH3YXedGF4&quot; =&gt; AdaptiveDensityApproximation.OneDimBlock(&quot;dH3YXedGF4&quot;, AdaptiveDensityApproximation.Interval{Float64, Float64}(9.540954763499962e-10, 1.3894954943731304e-9), [&quot;LKKSbxLnX8&quot;, &quot;ExjJctE9CV&quot;], 2.2412770711543273e-7)…))</code></pre><div class="admonition is-info"><header class="admonition-header">Why end-1 ?</header><div class="admonition-body"><p>Since the <code>offset</code> keyword was used for the creation of model functions (in our scenario), the <code>parameters</code> array has one additional element at the end, the offset, which does not belong to the grid. If no <code>offset</code> is used, all parameters should be imported:</p><pre><code class="language-julia hljs">import_weights!(grid, parameters)</code></pre><p>In fact, using the wrong selection of parameters usually leads to a <code>DimensionMismatch</code> error, as the number of parameters and the number of intervals in the grid do not match.</p></div></div><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; import_weights!(grid, parameters) # Wrong parameter selection should fail.</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: DimensionMismatch: The number of blocks in the grid and the number of weights to be imported do not match</code></pre><p>After importing the <code>parameters</code> into the grid, the dose-response curve can be constructed as before (for any concentrations, not only the data concentrations):</p><pre><code class="language-julia hljs">concentrations = LogRange(1e-8,1e-2,16)
result = DoseResponseResult(grid,concentrations; model = accumulation_model, offset = parameters[end])
scatter(result, xaxis = :log, ylims = [0,1.4])</code></pre><img src="3212833a.svg" alt="Example block output"/><p>Observe the <code>offset = parameters[end]</code> part at the end of the <a href="../API/#AntibodyMethodsDoseResponse.DoseResponseResult"><code>DoseResponseResult</code></a> call. In our scenario, the <code>parameters</code> array contains the offset as last element.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Models/">« Models</a><a class="docs-footer-nextpage" href="../DensityPlots/">Density plots for <code>OneDimGrid</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Wednesday 10 July 2024 21:21">Wednesday 10 July 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
